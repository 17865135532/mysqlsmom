# mysqlsmom

?????mysql???elasticsearch????

## ??

1. ?Pythoo???
2. ?????????????
3. ????????????????sql???????
4. ???????????
5. ??mysql??????????????????????elasticsearch?
6. ???????????????????

## ??

- python2.7?
- ?????????mysql??binlog?????redis?

## ????

1. clone ??????

2. ?????

   ```
   cd mysqlsmom
   pip install -r requirements.txt
   ```

   ???? elasticsearch-2.4??????????????5.4?????elasticsearch???

   ```
   pip install --upgrade elasticsearch==5.4
   ```

3. ?? ./config/example_init.py???????????

   ```python
   # coding=utf-8

   STREAM = "INIT"

   # ???????
   CONNECTION = {
       'host': '127.0.0.1',
       'port': 3306,
       'user': 'root',
       'passwd': ''
   }

   # ??elasticsearch??
   NODES = [{"host": "127.0.0.1", "port": 9200}]

   TASKS = [
       {
           "stream": {
               "database": "test_db",  # ???????sql??
               "sql": "select * from person"  # ??sql?????????? elasticsearch
           },
           "jobs": [
               {
                   "actions": ["insert", "update"],
                   "pipeline": [
                       {"set_id": {"field": "id"}}  # ???? id???? ?elasticsearch????id
                   ],
                   "dest": {
                       "es": {
                           "action": "upsert",
                           "index": "test_index",   # ?? index
                           "type": "test",          # ?? type
                           "nodes": NODES
                       }
                   }
               }
           ]
       }
   ]
   ```

4. ??

   ```
   cd mysqlsmom
   python mysqlsmom.py ./config/example_init.py
   ```

   ?????????

## ????

?????????????????????????issues?????24??????